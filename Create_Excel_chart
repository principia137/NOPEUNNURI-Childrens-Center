Sub 차트생성()
'
' 차트생성 매크로
'
' 바로 가기 키: Ctrl+g
'
   '변수선언
    Dim fp As Workbook
    Dim sht As Worksheet
    Dim cht As Chart
    Dim data As Range
    Dim i As Integer
    Dim top As Integer
    
    '개체 변수 값 할당
    Set fp = ThisWorkbook
    Set sht = fp.Sheets("영어 평가표 및 그래프")
    
    For i = 3 To 18 Step 1 '3행부터 18행 까지 반복
        top = i * 230 '차트 생성마다 230씩 횡으로 증가
        Set cht = sht.Shapes.AddChart2.Chart '차트 생성
        Set data = Union(sht.Range("$C" & i & ""), sht.Range("$C$2")) '다중 범위 지정
        'Set data = sht.Range("$C" & i & ":$E" & i & "")'단일 범위 지정
        
        With cht
            .SetSourceData Source:=data '범위 할당
            .ChartType = xlColumnClustered '차트 종류는 누적 세로막대그래프
            .HasTitle = True '차트 제목 추가
            .ChartTitle.Text = sht.Range("$B" & i & "") '차트 제목 범위
            With .ChartArea '차트 생성 위치 지정
                .left = 400
                .top = top
                End With
            End With
        Next i
End Sub
